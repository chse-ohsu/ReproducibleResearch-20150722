---
title:
  # Title must be 150 characters or less
  "Reproducible Research Demo using the PLoS template"
author: 
  - name: Ben Chan
    affiliation: '1'
    email: chanb@ohsu.edu
  - name: Stephanie Renfro
    affiliation: '2'
    email: renfrst@ohsu.edu
  - name: Thomas Meath
    affiliation: '2'
    email: meath@ohsu.edu
affiliation:
  - id: '1'
    department: Cheese
    institution: Oregon Health and Science University
    city: Portland
    state: OR
    country: USA
  - id: '2'
    department: Center for Health Systems Effectiveness
    institution: Oregon Health and Science University
    city: Portland
    state: OR
    country: USA
date: "`r format(Sys.time(), '%A, %d %B, %Y')`"
output: rticles::plos_article
csl: plos.csl
bibliography: references.bib
---

# Abstract {-}
The *Breeder diet* produces the highest growth in baby chicks after 21 weeks.
The *Grower diet* produces the least growth in baby chicks after 21 weeks.

# Author summary {-}
Please keep the Author Summary between 150 and 200 words Use first person. PLoS 
ONE authors please skip this step. Author Summary not valid for PLoS ONE 
submissions. 


# Introduction {-}

The research question this paper attempts to answer was generated by the following communication:

> From: Ben Chan  
> Sent: Thursday, June 11, 2015 4:04 PM  
> To: Stephanie Renfro  
> Subject: What to feed chicks  
> 
> Hello,  
> 
> I'm receiving 20 baby chicks next month. 
> Can you help me decide what to feed them? 
> I'm choosing between the following four diets:  
> 
> 1.  Grower diet  
> 2.  Layer diet
> 3.  Breeder diet
> 4.  High cluckage diet  
> 
> Thanks,
> Ben

Cite some fake references just to show how referencing using the `bibliography` parameter works 
[@pmid24913003] [@pmid20800442] [@pmid20966702] [@pmid19920273].


This paper uses 
[data from an experiment on the effect of diet on early growth of chicks](http://www.inside-r.org/r-doc/datasets/ChickWeight), 
`ChickWeight`, which comes pre-loaded in any R session. 
Unfortunately, R does not come pre-loaded with a llama dataset.

Convert to data.table for faster processing.

```{r}
library(data.table, quietly=TRUE)
ChickWeight <- data.table(ChickWeight)
```

Create a character variable for `diet`.
Use this variable for plotting small multiples.

```{r}
ChickWeight <- ChickWeight[, dietChr := sprintf("Diet %d", Diet)]
```

The first few rows of this data are shown below.

```{r}
head(ChickWeight)
```


# Results {-}

## Simple summary {-}

Below are summary statistics of all the variables of the data.

```{r}
summary(ChickWeight)
```


## Mean weights {-}

Just for fun, 
let's create a table showing mean weight at times 
0, 10, and 21 days, 
for each of the four diet types.

```{r, echo=FALSE}
library(xtable, quietly=TRUE)
mean_ChickWeight <- ChickWeight[Time %in% c(0,10,21),
                                list(mean_weight = round(mean(weight), digits=1)),
                                by = list(Diet,Time)]
```

```{r, results='asis', echo=FALSE}
print(xtable(mean_ChickWeight),
      type="latex",
      table.placement="h",
      include.rownames=FALSE,
      comment=FALSE)
```

## Growth curves {-}

```{r, echo=FALSE}
colorPalette <- function () {
  c(rgb(  1,  67, 134, maxColorValue=255),
    rgb(119, 120, 123, maxColorValue=255),
    rgb(139, 184, 234, maxColorValue=255),
    rgb(188, 190, 192, maxColorValue=255),
    rgb( 94, 122, 162, maxColorValue=255),
    rgb(223, 122,  28, maxColorValue=255))
}
```

The following plot illustrates the growth curve for individual chicks from 0 to 21 days.

Colors represent the four diets. 

**From this plot, it is difficult to distinguish between the performance of the four diets.**

```{r, echo=FALSE}
library(ggplot2, quietly=TRUE)
ggplot() +
  geom_line(data=ChickWeight, aes(x=Time, y=weight, color=dietChr, group=Chick)) +
  scale_color_manual("", values=colorPalette()) +
  ggtitle("Growth Curve for Individual Chicks")
```

Plot individual chick growth curves using small multiples.

```{r, echo=FALSE}
ggplot() +
  geom_line(data=ChickWeight, aes(x=Time, y=weight, color=dietChr, group=Chick)) +
  facet_wrap(~ dietChr, nrow=1) + 
  scale_color_manual(values=colorPalette()) +
  theme(legend.position="none") +
  ggtitle(bquote(atop("Growth Curve for Individual Chicks")))
```

Plot fitted growth curves using small multiples.
Data points are jittered around time value.

```{r, echo=FALSE, message=FALSE}
ggplot() +
  geom_jitter(data=ChickWeight, aes(x=Time, y=weight, colour=dietChr)) +
  geom_smooth(data=ChickWeight, aes(x=Time, y=weight, colour=dietChr)) +
  facet_wrap(~ dietChr, nrow=1) + 
  scale_color_manual(values=colorPalette()) +
  theme(legend.position="none") +
  ggtitle(bquote(atop("Fitted Growth Curves")))
```


## Final weight density {-}

Plot densities by diet for chicks' final weights (day 21) using small multiples.

```{r, echo=FALSE}
ggplot(ChickWeight[Time==21], aes(x=weight, colour=dietChr, fill=dietChr)) +
    geom_density() +
  facet_wrap(~ dietChr, nrow=4) + 
  scale_color_manual(values=colorPalette()) +
  scale_fill_manual(values=colorPalette()) +
  theme(legend.position="none") +
  ggtitle(bquote(atop("Density: Final Weight")))
```


# Discussion {-}

Reproducibility rocks!
End of discussion.


# Material and Methods {-}

Information on the R session that generated this paper is below.

```{r}
sessionInfo()
```


# Acknowledgments {-}
Do NOT remove this, even if you are not including acknowledgments

# References {-}
A reference list should be automatically created here. However it won't. Pandoc 
will place the list of references at the end of the document instead. There are 
no convenient solution for now to force Pandoc to do otherwise. The easiest way 
to get around this problem is to edit the LaTeX file created by Pandoc before 
compiling it again using the traditional LaTeX commands.

# Figure Legends {-}

# Tables {-}
